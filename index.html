<!DOCTYPE html>
<html ng-app="app">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>angular-eha.login-dialog</title>
    <link href="//cdn.jsdelivr.net/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <link href="//cdn.jsdelivr.net/fontawesome/4.3.0/css/font-awesome.css" rel="stylesheet">
  </head>
  <body>
    <div ng-controller="AppCtrl as ctrl">
      <p ng-if="ctrl.loggedIn" class="alert-success">Logged in</p>
      <p>Username: <code>test</code></p>
      <p>Password: <code>test</code></p>
      <button class="btn btn-info" ng-click="ctrl.login()">Login</button>
      <button class="btn btn-warning" ng-click="ctrl.logout()">Logout</button>
    </div>
    <script src="//cdn.jsdelivr.net/angularjs/1.3.14/angular.min.js"></script>
    <script src="//cdn.jsdelivr.net/angular.bootstrap/0.12.1/ui-bootstrap-tpls.min.js"></script>
    <script src="//cdn.jsdelivr.net/localforage/1.2.10/localforage.min.js"></script>
    <script src="//cdn.jsdelivr.net/pouchdb/4.0.0/pouchdb.min.js"></script>
    <script src="//cdn.rawgit.com/angular-pouchdb/bower-angular-pouchdb/master/angular-pouchdb.min.js"></script>
    <script src="//cdn.rawgit.com/nolanlawson/pouchdb-authentication/master/dist/pouchdb.authentication.min.js"></script>
    <script src="//cdn.rawgit.com/rubenv/angular-gettext/master/dist/angular-gettext.min.js"></script>
    <script src="//cdn.rawgit.com/eHealthAfrica/angular-eha.login-service/master/dist/login-service.js"></script>
    <script src="//rawgit.com/eHealthAfrica/angular-eha.login-dialog-bower/master/login-dialog.template.js"></script>
    <script>
      angular.module('app', [
        'eha.login-service',
        'eha.login-dialog'
      ])
        .config(function(ehaLoginServiceProvider) {
          ehaLoginServiceProvider.config('https://ehalogindialog.iriscouch.com/letsgo')
        })
        .controller('AppCtrl', function(ehaLoginService) {
          var self = this
          this.login = function() {
            ehaLoginService.maybeShowLoginUi()
              .then(function() {
                self.loggedIn = true
              })
          }
          this.logout = function() {
            ehaLoginService.logout()
              .then(function() {
                self.loggedIn = false
              })
          }
        })
    </script>
  </body>
</html>
